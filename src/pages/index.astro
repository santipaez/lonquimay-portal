---
import Layout from "../layouts/Layout.astro";
import Header from "../components/Header";
import Hero from "../components/Hero.astro";
import Footer from "../components/Footer.astro";
import InteractiveMap from "../components/InteractiveMap";
import WeatherWidget from "../components/WeatherWidget";
import WhatsAppButton from "../components/WhatsAppButton";
import "../styles/global.css";

const NEWS = [
  {
    id: 1,
    category: "Digital",
    title: "Nuevo Portal Digital de Lonquimay",
    snippet: "La Municipalidad de Lonquimay lanza su nuevo portal ciudadano digital, facilitando el acceso a trámites, servicios y información municipal desde cualquier dispositivo...",
    image: "https://images.unsplash.com/photo-1551650975-87deedd944c3?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=70"
  },
  {
    id: 2,
    category: "Obras",
    title: "Planificación Urbana y Hábitat",
    snippet: "Se presentó el nuevo plan de desarrollo urbano que incluye mejoras en infraestructura, espacios verdes y vivienda social para el crecimiento sostenible de la ciudad...",
    image: "https://images.unsplash.com/photo-1581092160562-40aa08e78837?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=70"
  },
  {
    id: 3,
    category: "Social",
    title: "Programas de Asistencia y Conservación",
    snippet: "El municipio continúa implementando programas de asistencia social y conservación del medio ambiente, trabajando junto a la comunidad para mejorar la calidad de vida...",
    image: "https://images.unsplash.com/photo-1500382017468-9049fed747ef?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=70"
  }
];

const getUnsplashSrcSet = (baseUrl: string): string => {
  const sizes = [300, 400, 500, 600];
  return sizes.map(size => {
    try {
      const url = new URL(baseUrl);
      url.searchParams.set('w', size.toString());
      url.searchParams.set('q', '70');
      return `${url.toString()} ${size}w`;
    } catch {
      return `${baseUrl}?w=${size}&q=70 ${size}w`;
    }
  }).join(', ');
};
---

<Layout 
	title="Lonquimay - Tu Municipio"
	description="Sitio oficial de la Municipalidad de Lonquimay, La Pampa. Acceso a trámites, requisitos, noticias, servicios municipales e información ciudadana. Corazón de la Pampa."
>
	<Header client:idle transparent={true} />
	<Hero />
	
	<main class="min-h-screen bg-gray-50 font-sans text-gray-800">
		<section class="relative z-20 pb-24 bg-slate-50">
			<div class="container mx-auto px-4 max-w-6xl">
				<div class="text-center pt-16 mb-28">
					<h2 class="text-3xl font-bold text-slate-800 mb-3">Acceso Rápido a Servicios</h2>
					<p class="text-slate-500 text-lg">Gestioná tus trámites y consultas de forma simple y rápida.</p>
				</div>

				<div class="-mt-20 grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6">
					<a href="/pagos" class="group bg-white p-8 rounded-3xl shadow-[0_10px_40px_-15px_rgba(0,0,0,0.1)] border border-slate-100 hover:-translate-y-2 hover:shadow-[0_20px_40px_-15px_rgba(22,163,74,0.2)] transition-all duration-300" aria-label="Ir a la sección de Pagos Online">
						<div class="w-16 h-16 rounded-2xl bg-green-50 text-green-600 flex items-center justify-center mb-6 group-hover:bg-green-600 group-hover:text-white transition-colors shadow-sm">
							<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
							</svg>
						</div>
						<h3 class="text-xl font-bold text-slate-800 mb-3 group-hover:text-green-700 transition-colors">Pagos Online</h3>
						<p class="text-slate-500 text-sm leading-relaxed">Consultá tus tasas municipales, imprimí cupones y realizá pagos desde casa.</p>
					</a>

					<a href="/tramites" class="group bg-white p-8 rounded-3xl shadow-[0_10px_40px_-15px_rgba(0,0,0,0.1)] border border-slate-100 hover:-translate-y-2 hover:shadow-[0_20px_40px_-15px_rgba(22,163,74,0.2)] transition-all duration-300" aria-label="Ir a la Guía de Trámites">
						<div class="w-16 h-16 rounded-2xl bg-green-50 text-green-600 flex items-center justify-center mb-6 group-hover:bg-green-600 group-hover:text-white transition-colors shadow-sm">
							<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
							</svg>
						</div>
						<h3 class="text-xl font-bold text-slate-800 mb-3 group-hover:text-green-700 transition-colors">Guía de Trámites</h3>
						<p class="text-slate-500 text-sm leading-relaxed">Requisitos claros para licencias, habilitaciones y catastro municipal.</p>
					</a>

					<a href="/novedades" class="group bg-white p-8 rounded-3xl shadow-[0_10px_40px_-15px_rgba(0,0,0,0.1)] border border-slate-100 hover:-translate-y-2 hover:shadow-[0_20px_40px_-15px_rgba(22,163,74,0.2)] transition-all duration-300" aria-label="Ir a la sección de Novedades">
						<div class="w-16 h-16 rounded-2xl bg-green-50 text-green-600 flex items-center justify-center mb-6 group-hover:bg-green-600 group-hover:text-white transition-colors shadow-sm">
							<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"></path>
							</svg>
						</div>
						<h3 class="text-xl font-bold text-slate-800 mb-3 group-hover:text-green-700 transition-colors">Novedades</h3>
						<p class="text-slate-500 text-sm leading-relaxed">Enterate de las últimas obras, eventos culturales y comunicados oficiales.</p>
					</a>

					<a href="/numeros-utiles" class="group bg-white p-8 rounded-3xl shadow-[0_10px_40px_-15px_rgba(0,0,0,0.1)] border border-slate-100 hover:-translate-y-2 hover:shadow-[0_20px_40px_-15px_rgba(22,163,74,0.2)] transition-all duration-300" aria-label="Ir a la sección de Teléfonos Útiles">
						<div class="w-16 h-16 rounded-2xl bg-green-50 text-green-600 flex items-center justify-center mb-6 group-hover:bg-green-600 group-hover:text-white transition-colors shadow-sm">
							<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
							</svg>
						</div>
						<h3 class="text-xl font-bold text-slate-800 mb-3 group-hover:text-green-700 transition-colors">Teléfonos Útiles</h3>
						<p class="text-slate-500 text-sm leading-relaxed">Listado de números de emergencia: Policía, Bomberos, Hospital y Guardia.</p>
					</a>
				</div>
			</div>
		</section>

		<section class="py-12 bg-white">
			<div class="container mx-auto px-4">
				<div class="flex justify-between items-end mb-10 max-w-6xl mx-auto">
					<div>
						<h2 class="text-2xl md:text-3xl font-bold text-gray-800">Noticias Recientes</h2>
						<div class="h-1 w-20 bg-green-700 mt-3 rounded-full"></div>
					</div>
					<a href="/novedades" class="hidden md:block text-green-700 font-bold hover:underline" aria-label="Ver todas las noticias">Ver todas</a>
				</div>

				<div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-6xl mx-auto">
					{NEWS.map((news) => (
						<article class="bg-white rounded-2xl overflow-hidden border border-gray-100 shadow-sm hover:shadow-xl hover:shadow-green-100/50 transition-all group cursor-pointer">
							<div class="h-48 overflow-hidden relative bg-gray-200">
								<span class="absolute top-4 left-4 bg-green-700 text-white text-xs font-bold px-3 py-1 rounded-full z-10">
									{news.category}
								</span>
								<img
									src={news.image}
									srcset={getUnsplashSrcSet(news.image)}
									sizes="(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 400px"
									alt={news.title}
									class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"
									loading="lazy"
									decoding="async"
									width={400}
									height={200}
								/>
							</div>
							<div class="p-6">
								<h3 class="font-bold text-lg mb-2 leading-tight group-hover:text-green-700 transition-colors">
									{news.title}
								</h3>
								<p class="text-gray-600 text-sm line-clamp-3">
									{news.snippet}
								</p>
							</div>
						</article>
					))}
				</div>
				<div class="mt-8 text-center md:hidden">
					<a href="/novedades" class="text-green-700 font-bold hover:underline inline-block" aria-label="Ver todas las noticias">Ver todas las noticias</a>
				</div>
			</div>
		</section>

		<section class="py-16 bg-white" aria-labelledby="mapa-titulo">
			<div class="container mx-auto px-4">
				<div class="max-w-6xl mx-auto">
					<h2 id="mapa-titulo" class="text-2xl md:text-3xl font-bold text-gray-800 mb-8 text-center">Mapa Interactivo</h2>
					<div class="relative rounded-lg overflow-hidden">
						<InteractiveMap client:visible height="500px" showTitle={false} />
					</div>
					<div class="mt-8 text-center">
						<a
							href="/mapa"
							class="inline-flex items-center gap-2 text-green-700 font-bold hover:underline"
							aria-label="Ver mapa completo de Lonquimay"
						>
							Ver mapa completo
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
								<path d="M5 12h14M12 5l7 7-7 7"/>
							</svg>
						</a>
					</div>
				</div>
			</div>
		</section>

		<section class="py-16 bg-[#f8fafc]">
			<div class="container mx-auto px-4">
				<div class="grid md:grid-cols-2 gap-12 items-center max-w-5xl mx-auto">
					<div class="order-2 md:order-1">
						<WeatherWidget client:visible />
					</div>
					<div class="order-1 md:order-2 space-y-6">
						<h2 class="text-3xl font-bold text-gray-800">Lonquimay: Corazón de la Pampa</h2>
						<p class="text-gray-600 leading-relaxed">
							Descubrí la inmensidad de nuestra llanura. En Lonquimay, la tranquilidad y la tradición se encuentran en cada rincón. Un pueblo seguro, de gente cálida, donde el horizonte se une con el cielo.
						</p>
						<div class="grid grid-cols-2 gap-4 pt-4">
							<div class="bg-white p-4 rounded-xl shadow-sm border border-gray-100">
								<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#7bc143" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-2" aria-hidden="true">
									<path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
									<circle cx="12" cy="10" r="3"/>
								</svg>
								<h3 class="font-bold text-lg">Ubicación</h3>
								<p class="text-sm text-gray-600">Ruta Nacional 5</p>
							</div>
							<div class="bg-white p-4 rounded-xl shadow-sm border border-gray-100">
								<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#4a9bb7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-2" aria-hidden="true">
									<path d="M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2m5.8-7.4L7 4.9m0 0L9 2m-2 2.9L2.5 4.5M7 4.9l-.5-1.4M7 4.9l.5 1.4m12-1.4L20 2m2 2.9l-4-2.4M20 4.9l-.5-1.4M20 4.9l.5 1.4"/>
								</svg>
								<h3 class="font-bold text-lg">Cuna de la Tradición</h3>
								<p class="text-sm text-gray-600">Cultura y Raíces</p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>
	</main>

	<Footer />
	<WhatsAppButton client:idle />
</Layout>
